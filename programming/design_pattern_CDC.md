# 異動資料擷取 CDC

> Change Data Capture（CDC，異動資料擷取）是一種技術與設計模式，能夠即時或近即時地捕捉資料庫中資料的變更（新增、更新、刪除），並將這些變更資料同步至其他系統，用於資料整合、實時分析、備份或災難復原等場景。

## 特點

- **增量擷取**：只捕捉資料的變更部分，避免全量重複讀取，提升效率。
- **時序性**：以時間順序記錄資料變動，確保資料一致性和可追蹤性。
- **非侵入式**：多數 CDC 技術不需修改原業務系統表結構，透過監控資料庫日誌（如 MySQL Binlog、Postgres WAL）實現。
- **低延遲**：可達近即時資料同步，滿足實時分析需求。
- **多種實現方式**：包括程式碼層面紀錄、資料庫觸發器（Trigger）、資料庫日誌解析等。

## 主要用途

- **資料同步**：將交易系統資料同步至資料倉庫、資料湖或 OLAP 系統，避免查詢主庫造成負載。
- **實時分析**：支援即時 BI 報表、監控與決策系統。
- **資料整合**：跨異質資料庫或多系統資料合併。
- **備份與災難復原**：利用變更日誌重建資料狀態。
- **事件驅動架構**：觸發後續業務流程或微服務。

## 優缺點

| 項目       | 優點                                                 | 缺點                                                     |
| ---------- | ---------------------------------------------------- | -------------------------------------------------------- |
| 效率       | 只擷取變更資料，減少資料傳輸與處理量，提升同步效率。 | 需要額外管理變更日誌，初期配置與維護較複雜。             |
| 實時性     | 可達近即時資料同步，滿足即時分析需求。               | 延遲仍存在，且受限於資料庫日誌產生與消費速度。           |
| 系統負擔   | 非侵入式，對原業務系統影響小，不需修改表結構。       | 某些實作（如觸發器）會增加資料庫負擔，影響性能。         |
| 彈性       | 支援多種資料庫與異構系統，方便資料整合。             | 不同資料庫日誌格式與管理方式差異大，實作與維護門檻較高。 |
| 資料完整性 | 支援事務一致性，確保資料同步正確。                   | 需嚴格管理日誌大小與保留時間，避免資料丟失。             |

## 使用情境

| 情境描述                       | 適用 CDC 方案與說明                                                                |
| ------------------------------ | ---------------------------------------------------------------------------------- |
| **即時資料同步與報表分析**     | 使用基於日誌的 CDC（如 Debezium 監控 MySQL Binlog），搭配 Kafka 實現近即時資料流。 |
| **多資料源整合與格式轉換**     | 使用 Apache NiFi 等工具，結合 CDC 實現多格式、多來源資料流轉與清洗。               |
| **批次資料同步與歷史資料更新** | 使用 Apache Airflow 調度批次 ETL 任務，結合 CDC 補足批次更新與聚合。               |
| **資料庫備份與災難復原**       | 利用 CDC 日誌重放功能，快速恢復資料庫狀態。                                        |
| **事件驅動微服務架構**         | CDC 捕捉資料變更事件，觸發後續微服務流程。                                         |
| **無法修改原系統結構的環境**   | CDC 非侵入式特性，適合無法改動業務資料庫結構的場景。                               |

---

## 總結

CDC 是一種高效、靈活的資料變更擷取技術，能在不影響主系統的情況下，實現資料的即時同步與分析。其核心優勢在於增量擷取與低延遲，但實作需考慮資料庫類型、系統負載、資料一致性及運維複雜度，選擇適合的 CDC 工具與架構方案，才能發揮最大效益。

---

**參考來源:**

[1] https://www.cnblogs.com/xqzt/p/4513404.html \
[2] https://www.omniwaresoft.com.tw/techcolumn/kafka-techcolumn/what-is-cdc/ \
[3] http://bbs.cqsztech.com/forum.php?mod=viewthread&tid=31415 \
[4] https://cn.pingcap.com/article/post/5344.html \
[5] https://www.cdc.gov.tw/Uploads/files/399735c6-6642-4919-a562-9d9dacd3e700.pdf \
[6] https://blog.csdn.net/qq_40948559/article/details/127340065 \
[7] https://open.oceanbase.com/blog/18959532898 \
[8] https://tapdata.net/cdc-data-synchronization-real-time-solutions.html

---

[返回目錄](./../README.md)
