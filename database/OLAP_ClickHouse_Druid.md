## ClickHouse 與 Druid 詳細比較

| 項目         | ClickHouse                                                                                                                             | Druid                                                                                                                                              |
| ------------ | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| **核心架構** | 列式資料庫，專為高效能分析設計，支援分散式處理與高壓縮；<br>支持多種資料模型（星型、雪花型）                                           | 實時分析資料庫，採用分段（columnar segment）存儲與分散式架構，<br>專注時間序列數據和事件驅動分析                                                   |
| **主要特點** | - 向量化查詢執行<br>- 高效壓縮<br>- 支援標準 SQL<br>- 支援分片與資料複製<br>- 物化視圖加速聚合查詢<br>- 以批次查詢為主，流式需額外配置 | - 原生實時資料攝取（毫秒級延遲）<br>- 自動索引（bitmap、inverted）<br>- 寫入時聚合<br>- 高併發支援<br>- 支援 SQL 與 REST API<br>- 分段存儲         |
| **優點**     | - 查詢速度極快，適合大規模歷史數據深度分析<br>- 儲存效率高，支援複雜查詢與多表 JOIN<br>- 易於橫向擴展<br>- 物化視圖提升聚合效能        | - 真正即時資料攝取與查詢，查詢延遲低<br>- 自動化索引提升查詢效率<br>- 支援高併發及寫入時聚合<br>- 適合時間序列與事件分析<br>- 雲原生，易擴展與容錯 |
| **缺點**     | - 實時資料攝取能力不及 Druid，流式需額外設置<br>- 多表 JOIN 大量時效能下降<br>- 對事務支援有限，不適合 OLTP<br>- 資料結構需事先定義    | - 複雜 JOIN 支援有限，需資料去正規化<br>- 儲存成本較高（資料不可變，分段存儲）<br>- 通用分析彈性較低<br>- 查詢語法與標準 SQL 有差異                |
| **適用場景** | - 大規模歷史數據分析（OLAP）<br>- 即時儀表板<br>- 日誌、事件與用戶行為分析<br>- ETL 數據倉儲<br>- IoT、金融、營運監控                  | - 即時資料流分析（IoT、網站互動、監控）<br>- 高併發即時儀表板<br>- 運營監控、商業智能<br>- 廣告、行銷、網路遙測<br>- 需寫入時聚合的場景            |
| **代表案例** | Uber 日誌分析、金融 KPI 儀表板、行銷數據平台                                                                                           | 網站即時互動分析、IoT 即時監控、廣告投放分析                                                                                                       |

---

## ClickHouse 詳細說明

**核心與特點**

- 列式存儲，查詢僅需讀取相關欄位，提升 I/O 效率與壓縮率[1][3][7]。
- 向量化查詢執行與並行處理，充分利用 CPU 與多核心資源[1][7]。
- 支援分片與複製，可橫向擴展至多台伺服器[3][7]。
- 物化視圖可自動預聚合數據，加速查詢[7]。
- 支援 SQL 查詢，語法接近標準 SQL，易於上手[7]。
- 適合批次資料處理，也可支援流式（需額外設置 Kafka 等）[1][6]。

**優點**

- 查詢速度極快，適合大數據量下的深度分析[1][3][5][7]。
- 儲存壓縮率高，節省空間[1][7]。
- 支援複雜查詢與多表 JOIN（但 JOIN 過多會影響效能）[6]。
- 易於橫向擴展，支援高可用[7]。

**缺點**

- 原生實時資料攝取能力不如 Druid，流式需額外設置[6]。
- 適合 OLAP，不適合高頻交易型 OLTP[5]。
- JOIN 過多或複雜關聯時效能下降[6]。
- 資料結構需事先定義，彈性較低[6]。

**應用場景**

- OLAP 歷史數據分析
- 即時儀表板
- 日誌、事件、用戶行為分析
- ETL 數據倉儲
- IoT 與金融監控[1][3][5][7]

---

## Druid 詳細說明

**核心與特點**

- 分段(columnar segment)存儲，資料不可變，僅支援追加[4][6]。
- 原生支援實時流式資料攝取（Kafka/Kinesis 等）與批次資料[4][6]。
- 寫入時聚合（write-time aggregation），常見聚合可預先計算[2]。
- 自動化索引（bitmap/inverted），高效支援高基數查詢[4][6]。
- 高併發設計，適合多用戶同時查詢[2][4][6]。
- 支援 SQL 與 REST API 查詢[4]。
- 雲原生，支援自動容錯與彈性擴展[4]。

**優點**

- 真正實時資料攝取與查詢，適合事件驅動與時間序列分析[4][6]。
- 寫入時聚合提升查詢效率，適合重複聚合查詢[2]。
- 高併發查詢能力，適合即時儀表板[2][4][6]。
- 自動索引，查詢延遲低[4][6]。
- 可獨立擴展攝取、儲存、查詢節點[6]。

**缺點**

- 複雜 JOIN 支援有限，需資料預先去正規化[2][6]。
- 儲存成本較高，因為資料不可變且分段存儲[6]。
- 查詢語法與傳統 SQL 略有差異，需適應[4][6]。
- 更適合時間序列與事件分析，通用性略低[6]。

**應用場景**

- 即時資料流分析（IoT、網站互動、監控）[2][4][6]
- 高併發儀表板
- 運營監控、商業智能
- 廣告、行銷、網路遙測
- 寫入時聚合需求的場景[2][4][6]

---

**資料來源:**

[1] https://celerdata.com/glossary/what-is-clickhouse \
[2] https://risingwave.com/blog/clickhouse-vs-druid-the-right-choice-comparison/ \
[3] https://dotcommagazine.com/2024/03/clickhouse-top-ten-powerful-things-you-need-to-know/ \
[4] https://www.xenonstack.com/blog/apache-druid \
[5] https://blog.usro.net/2024/10/exploring-clickhouse-use-cases-when-to-use-it-and-when-it-falls-short/ \
[6] https://celerdata.com/glossary/clickhouse-vs-apache-druid \
[7] https://www.chaosgenius.io/blog/clickhouse-architecture/

---

[返回目錄](./../README.md)
